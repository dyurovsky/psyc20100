
---
title: "Regression and ANOVA for Professor ratings"
output:
  pdf_document: 
    fig_width: 4
    fig_height: 2.5
  html_document: default
---

```{r}
library(dplyr)
library(ggplot2)
library(readr)

theme_set(theme_bw(base_size = 16))
```

Load in professor rating data
```{r load_data}
prof_data <- read.csv("https://dyurovsky.github.io/psyc20100/data/demos/prof_data.csv")

head(prof_data)
```

Scatter plot of beauty vs. professor evaluation
```{r plot}
qplot(data = prof_data, x = beauty, y = profevaluation) 
```

Full model
```{r full_model}
prof_lm <- lm(profevaluation ~ beauty + gender + age + formal + lower + 
                native + minority + students + tenure, data = prof_data)

summary(prof_lm)
```

Stepwise regression
```{r stepwise}
lm_null <- lm(profevaluation ~ 1, data = prof_data)

lm_all <- lm(profevaluation ~ ., data = prof_data)

# Backwards stepwise using defaults
lm_step <- step(lm_all)

# Forward stepwise starting from null model
lm_forward <- step(lm_null, scope = list(lower = lm_null, upper = lm_all), direction = "forward")

# Backward stepwise without defaults
lm_backward <- step(lm_all, scope = list(lower = lm_null, upper = lm_all), direction = "backward")
```

Doing anova in R
```{r anova}
tenure_anova <- aov(profevaluation ~ tenure, data = prof_data)

summary(tenure_anova)

group_means <- prof_data %>%
  select(profevaluation, tenure) %>%
  group_by(tenure) %>%
  summarise(mean = mean(profevaluation), n = n())
group_means

overall_mean <- prof_data %>%
  select(profevaluation) %>%
  summarise(mean = mean(profevaluation), n = n())

qplot(x = seq(.01,10,.01), y = df(seq(.01,10,.01), 2, 450), 
      geom = "point", size = I(.5)) + 
  theme(panel.grid = element_blank()) + 
  xlab("F value") + 
  ylab("Probability") + 
  geom_vline(aes(xintercept = 2.706), color = "darkred", size = 1)

```

Comparing anova and linear regression
```{r anova_vs_lm}
summary(aov(profevaluation ~ tenure, data = prof_data))

summary(lm(profevaluation ~ tenure, data = prof_data))
```