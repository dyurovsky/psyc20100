
---
title: "Inference for regression"
output:
  pdf_document: 
    fig_width: 3.75
    fig_height: 2.5
  html_document: default
---

Load libraries and set theme
```{r load_libraries, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)

theme_set(theme_bw(base_size = 18))
```

load twin iq data and have a look at the first few rows
```{r load_data}
twins <- read.csv("https://dyurovsky.github.io/psyc20100/data/demos/twins.csv")
head(twins)
```

find the correlation between the iq of twin a and twin b
```{r corr}
twin_cor <- cor(twins$twin_a, twins$twin_b)

twin_cor
```

make a scatterplot of the relationship between twin a and b iqs. Also plot a regression line and annotate with the correlation coefficient.
```{r fig.width = 5, fig.height = 4}
qplot(data = twins, x = twin_a, y = twin_b) +
  geom_smooth(method = "lm", se = FALSE, color = "darkred") + 
  annotate("text", x = 75, y = 120, size = 6,
           label = paste0("r = ", round(twin_cor, digits = 2)))
```

make a linear regression predicting twin b from twin a
```{r lm}
twin_lm <- lm(twin_b ~ twin_a, data = twins)
summary(twin_lm)
```

the slope of a regression line is equal to the correlation when the independent and dependent variabels are both standardiZed and no slope is fit
```{r}
scale_twins <- twins %>%
  mutate_each(funs(scale), twin_a, twin_b)

scale_twin_lm <- lm(twin_b ~ twin_a + 0, data = scale_twins)

summary(scale_twin_lm)
twin_cor
```

That's becasue the slope of a regression line is r * sd_x / sd_y
```{r slope}
twin_cor * sd(twins$twin_b)/sd(twins$twin_a) 

coef(twin_lm)["twin_a"]
```